<app-nav></app-nav>
<app-menu></app-menu>
<div class="container">
  <h3>Editar</h3>
  <form *ngIf="datosCargados" [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <!-- Campo de SelecciÃ³n de Rol (Visible para todos los roles) -->
    <div class="form-group">
      <label for="role">Rol: </label>
      <select id="role" formControlName="role" class="form-control" required
        (change)="updateAdditionalFields(userForm.value.role)">
        <option value="">Selecciona un rol</option>
        <option value="INVESTIGADOR">Investigador</option>
        <option value="COORDINADOR">Director</option>
      </select>
      <div *ngIf="userForm.get('role')?.invalid && userForm.get('role')?.touched" class="text-danger">
        Por favor seleccione un rol.
      </div>
    </div>

    <!-- Campos adicionales para INVESTIGADOR y COORDINADOR -->
    <div *ngIf="userForm.value.role === 'INVESTIGADOR' || userForm.value.role === 'COORDINADOR'">
      <div class="form-group">
        <label for="instituto">Instituto:</label>
        <select id="instituto" formControlName="instituto" class="form-control"
          [required]="userForm.value.role !== 'ADMIN'">
          <option value="">Selecciona un instituto</option>
          <option *ngFor="let instituto of institutos" [value]="instituto.id">{{ instituto.nombre }}</option>
        </select>
        <div *ngIf="userForm.get('instituto')?.invalid && userForm.get('instituto')?.touched" class="text-danger">
          Por favor seleccione un instituto.
        </div>
      </div>

      <!-- Primer Nombre (Obligatorio) -->
      <div class="form-group">
        <label for="nombre1">Primer nombre:</label>
        <input type="text" id="nombre1" formControlName="nombre1" class="form-control"
          placeholder="Ingrese el primer nombre" (keypress)="onKeyPress($event, 'nombre1')"
          (input)="onInput($event, 'nombre1')" />
        <div *ngIf="userForm.get('nombre1')?.invalid && userForm.get('nombre1')?.touched" class="text-danger">
          Por favor ingrese un primer nombre.
        </div>
      </div>

      <!-- Segundo Nombre (Opcional) -->
      <div class="form-group">
        <label for="nombre2">Segundo nombre:</label>
        <input type="text" id="nombre2" formControlName="nombre2" class="form-control"
          placeholder="Ingrese el segundo nombre" (keypress)="onKeyPress($event, 'nombre2')"
          (input)="onInput($event, 'nombre2')" />
      </div>

      <!-- Apellido Paterno (Obligatorio) -->
      <div class="form-group">
        <label for="apellidoPaterno">Apellido Paterno:</label>
        <input type="text" id="apellidoPaterno" formControlName="apellidoPaterno" class="form-control"
          placeholder="Ingrese el apellido paterno" (keypress)="onKeyPress($event, 'apellidoPaterno')"
          (input)="onInput($event, 'apellidoPaterno')" />
        <div *ngIf="userForm.get('apellidoPaterno')?.invalid && userForm.get('apellidoPaterno')?.touched"
          class="text-danger">
          Por favor ingrese un apellido paterno.
        </div>
      </div>

      <!-- Apellido Materno (Opcional) -->
      <div class="form-group">
        <label for="apellidoMaterno">Apellido Materno:</label>
        <input type="text" id="apellidoMaterno" formControlName="apellidoMaterno" class="form-control"
          placeholder="Ingrese el apellido materno" (keypress)="onKeyPress($event, 'apellidoMaterno')"
          (input)="onInput($event, 'apellidoMaterno')" />
      </div>

    </div>

    <button type="submit" class="btn btn-primary btn-block">Actualizar</button>
    <button type="button" class="btn btn-danger btn-block" (click)="cancel()">Cancelar</button>
  </form>
</div>